## Wallet Server

#### 프로젝트 소개 및 특징
휴대폰에서 기본적으로 제공하는 Wallet 서비스. 그래서 가입자, 이용자 수가 많은 것이 특징이다.

#### 프로젝트 구성
1. Wallet 앱의 요청을 처리하는 Service Gateway 서버.
2. 서비스와 업체에 대한 승인 및 컨텐츠를 관리하는 Admin Web server
3. 컨텐츠를 등록하는 CMS(Contents Management System) Web Server.
4. 대외 서비스에 대한 중앙화 목적으로 만들어진 Gateway 중계서버로 구성된다.

#### 프로젝트에서 역할
1. 실 사용자, 운영 관리자로부터 문의에 대한 로그 확인 및 수정 대응
2. DB 쿼리 성능 개선

#### 프로젝트를 통해 배운 점.  
1. 오래된 시스템, SQL 중심의 개발방식에 대한 문제점 인식.  
 가장 어려운 점은 현재 운영중인 서비스를 운영/개발을 하다보니 코드수정과 수정에 대한 사이드이펙트 체크에 대한 이슈를 해결하는 것이다. 왜냐하면 업무로직이 SQL 중심이므로 중복되는 코드가 많고, 유사한 쿼리가 분산되어 있어 히스토리를 알지 못하면 수정이 불가능하다. 수정하고자 하는 기능과 연관된 쿼리가 어디에 있는지 모두 파악해야 수정이 가능하고, 테스트를 해야한는 범위가 많아진다.

2. TDD등 테스트 자동화에 대한 필요성 인식.  
 기능에 대한 수정, 수정사항에 대한 기능 확인, 사이드이펙트 확인, 사이드이펙트 제거, 그리고 다시 처음부터 수정사항에 대한 기능 확인... 하나의 테스트가 실패함으로써 기존 코드가 수정이되면 다른 테스트에 영향을 끼칠 수 있다. 이런 문제는 설계나 개발단위에서 어떻게 테스트 가능한 한목으로 나누고, 테스트를 자동화할 것인지에 대해 기술적으로나 도구를 잘 사용해야겠다는 것을 많이 느꼈다.

3. 많은 가입자/이용자에 대해 많은 것을 고민해야 한다.  
 통신사 앱이 사용자들에게 좋은 피드백을 받지는 못하지만, 기본적으로 설치되어 있는 단말의 수가 굉장히 많고 다양한 이슈가 발생하게 된다. 이런 앱의 특징으로 동시가입자는 많지 않지만 총 가입자수와 누적 데이터는 의외로 많다(엄청나게 많은 데이터까지는 아닌듯). 그래서 이러한 누적데이터로 인한 히스토리성 데이터를 조회가 안되는 경우가 많이 발생한다. 그래서 Table 설계나 쿼리할 경우 누적되는 데이터 건 수에 대해 충분히 고려하고 설계를 해야한다. 이런 경우 쿼리의 수정/추가 사항에 대해서는 쿼리플랜을 반드시 확인하고 상용데이터의 데이터분포나(가끔) 갯수를 어느정도 맞추고 테스트하는 과정을 거쳐 검증을 했다.
 
4. Log의 중요성과 해결책에 대한 고민.  
 민원이 이입되면 수많은 Gateway 서버에 다중으로 접속해 로그를 뒤져야한다. 이런 문제에 대한 나름대로의 해결책은 다음과 같이 생각한다.
    1. 로그 서버 중앙화.
    2. 로그 데이터 표준화.  

5. 타 서비스와의 연동 및 설계에 대한 고민.  
 연동서비스가 많다보니 각 서비스마다 연동방식이 조금씩 또는 크게 다르다. 코드 리펙토링을 통해 연동에 필요한 로직에 대해 추상화하고자 했지만, 이런 노력보다는 오히려 해당 서비스의 연동 Flow를 더 고민하는것이 효율적이였다. 그리고 코딩하기 이전에 충분히 시나리오에 대한 검증이 먼저 필요하다.
